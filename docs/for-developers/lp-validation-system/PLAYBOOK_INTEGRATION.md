# LPæ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ  Ã— ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯çµ±åˆè¨­è¨ˆ

## æ¦‚è¦

LPæ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ ã¯ã€æ—¢å­˜ã®ã€Œãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯é§†å‹•å‹ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã€ã¨å¯†æ¥ã«é€£æºã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®çµ±åˆã«ã‚ˆã‚Šã€æ¨™æº–åŒ–ã•ã‚ŒãŸLPæ¤œè¨¼ãƒ—ãƒ­ã‚»ã‚¹ï¼ˆPB-001ï¼‰ã®è‡ªå‹•å®Ÿè¡Œã¨ã€ãƒ•ã‚§ãƒ¼ã‚ºç§»è¡Œåˆ¤å®šã®ä½“ç³»çš„ãªç®¡ç†ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

## ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯ä½“ç³»ã¨ã®é–¢ä¿‚

### ğŸ¯ æ—¢å­˜ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯æ§‹é€ 
```
PB-001: LP CVRãƒ†ã‚¹ãƒˆï¼ˆãƒ•ã‚§ãƒ¼ã‚º1ï¼‰
â”œâ”€ ç›®çš„: CVR 10%ä»¥ä¸Šã§ãƒ‹ãƒ¼ã‚ºæ¤œè¨¼
â”œâ”€ æœŸé–“: 3-5æ—¥ã€ã‚µãƒ³ãƒ—ãƒ«1000ä»¥ä¸Š
â”œâ”€ æˆåŠŸåŸºæº–: CVRâ‰¥10%, p<0.05, nâ‰¥1000
â””â”€ å¤±æ•—åŸºæº–: CVR<5%, 5æ—¥çµŒé

PB-002: MVPæ§‹ç¯‰ï¼ˆãƒ•ã‚§ãƒ¼ã‚º2ï¼‰â€»äºˆå®š
â”œâ”€ å‰æ: PB-001æˆåŠŸ
â”œâ”€ æœŸé–“: 4-6é€±é–“
â””â”€ ç›®æ¨™: é€±æ¬¡200äººã€è»¢æ›ç‡7%

PB-003: ã‚°ãƒ­ãƒ¼ã‚¹æ–½ç­–ï¼ˆãƒ•ã‚§ãƒ¼ã‚º3ï¼‰â€»äºˆå®š
â”œâ”€ å‰æ: PB-002æˆåŠŸ
â””â”€ ç›®æ¨™: æŒç¶šçš„æˆé•·
```

### ğŸ”„ LPæ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ ã®å½¹å‰²
LPæ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ ã¯ã€Œ**PB-001ã®è‡ªå‹•å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³**ã€ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ï¼š

- **è‡ªå‹•å®Ÿè¡Œ**: PB-001ã®æ‰‹é †ã‚’4æ™‚é–“ãƒ»24æ™‚é–“ã‚µã‚¤ã‚¯ãƒ«ã§è‡ªå‹•åŒ–
- **é€²æ—ç›£è¦–**: ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯å®Ÿè¡ŒçŠ¶æ³ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¿½è·¡
- **åˆ¤å®šæ”¯æ´**: æˆåŠŸãƒ»å¤±æ•—åŸºæº–ã®è‡ªå‹•è©•ä¾¡ã¨AIæ¨å¥¨
- **æ¬¡ãƒ•ã‚§ãƒ¼ã‚ºç§»è¡Œ**: PB-002ã¸ã®ç§»è¡Œåˆ¤å®šãƒ»æ‰¿èªãƒ•ãƒ­ãƒ¼

## çµ±åˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆï¼ˆConvex Schemaæ‹¡å¼µï¼‰

```typescript
// ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯å®Ÿè¡Œç®¡ç†
playbookExecutions: defineTable({
  workspace_id: v.string(),
  product_id: v.string(),
  execution_id: v.string(),
  
  // ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯æƒ…å ±
  playbook_id: v.string(), // "PB-001", "PB-002", etc.
  playbook_version: v.string(), // "1.0.0"
  phase: v.number(), // 1, 2, 3
  
  // å®Ÿè¡ŒçŠ¶æ…‹
  status: v.union(
    v.literal("not_started"),
    v.literal("running"), 
    v.literal("completed"),
    v.literal("failed"),
    v.literal("cancelled")
  ),
  
  // KPIç›®æ¨™ãƒ»å®Ÿç¸¾
  target_metrics: v.object({
    cvr_min: v.number(), // 0.10
    sample_size: v.number(), // 1000  
    confidence_level: v.number(), // 0.95
    duration_days: v.number(), // 5
  }),
  
  current_metrics: v.object({
    cvr: v.number(),
    total_sessions: v.number(),
    total_conversions: v.number(),
    statistical_significance: v.boolean(),
    p_value: v.optional(v.number()),
  }),
  
  // æˆåŠŸãƒ»å¤±æ•—åˆ¤å®š
  success_criteria: v.array(v.object({
    criterion: v.string(),
    target: v.any(),
    current: v.any(),
    satisfied: v.boolean(),
  })),
  
  // AIåˆ†æãƒ»æ¨å¥¨
  ai_analysis: v.optional(v.object({
    recommendation: v.union(
      v.literal("continue"),
      v.literal("success"),
      v.literal("failure"),
      v.literal("extend")
    ),
    confidence: v.number(),
    reasoning: v.string(),
    next_actions: v.array(v.string()),
  })),
  
  // å®Ÿè¡Œå±¥æ­´
  started_at: v.number(),
  completed_at: v.optional(v.number()),
  duration_ms: v.optional(v.number()),
  
  // é–¢é€£ã‚»ãƒƒã‚·ãƒ§ãƒ³
  lp_validation_session_id: v.string(),
  
  created_at: v.number(),
  updated_at: v.number(),
})
.index("by_workspace", ["workspace_id"])
.index("by_product", ["product_id"])
.index("by_playbook", ["playbook_id"])
.index("by_status", ["status"])
.index("by_product_status", ["product_id", "status"]),

// ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯ã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡Œè©³ç´°
playbookStepExecutions: defineTable({
  workspace_id: v.string(),
  execution_id: v.string(), // è¦ªã®playbookExecutions
  step_id: v.string(),
  
  // ã‚¹ãƒ†ãƒƒãƒ—æƒ…å ±
  step_name: v.string(),
  step_order: v.number(),
  step_type: v.union(
    v.literal("data_collection"),
    v.literal("analysis"),
    v.literal("optimization"),
    v.literal("decision_point"),
    v.literal("notification")
  ),
  
  // å®Ÿè¡ŒçŠ¶æ…‹
  status: v.union(
    v.literal("pending"),
    v.literal("running"),
    v.literal("completed"),
    v.literal("failed"),
    v.literal("skipped")
  ),
  
  // å®Ÿè¡Œçµæœ
  input_data: v.any(),
  output_data: v.any(),
  execution_details: v.any(),
  
  // ã‚¨ãƒ©ãƒ¼æƒ…å ±
  error_message: v.optional(v.string()),
  retry_count: v.number(),
  
  started_at: v.number(),
  completed_at: v.optional(v.number()),
  duration_ms: v.optional(v.number()),
  
  created_at: v.number(),
})
.index("by_execution", ["execution_id"])
.index("by_status", ["status"])
.index("by_step_order", ["execution_id", "step_order"]),
```

### ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³

```typescript
// convex/playbooks/pb001-executor.ts
export class PB001Executor {
  constructor(
    private ctx: MutationCtx,
    private productId: string,
    private sessionId: string
  ) {}

  async execute(): Promise<PlaybookExecution> {
    const executionId = ulid();
    
    // 1. ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯å®Ÿè¡Œé–‹å§‹
    await this.ctx.db.insert("playbookExecutions", {
      workspace_id: "unson",
      product_id: this.productId,
      execution_id: executionId,
      playbook_id: "PB-001",
      playbook_version: "1.0.0", 
      phase: 1,
      status: "running",
      target_metrics: {
        cvr_min: 0.10,
        sample_size: 1000,
        confidence_level: 0.95,
        duration_days: 5,
      },
      current_metrics: {
        cvr: 0,
        total_sessions: 0,
        total_conversions: 0,
        statistical_significance: false,
      },
      success_criteria: [
        {
          criterion: "CVR_TARGET",
          target: 0.10,
          current: 0,
          satisfied: false,
        },
        {
          criterion: "SAMPLE_SIZE",
          target: 1000,
          current: 0,
          satisfied: false,
        },
        {
          criterion: "STATISTICAL_SIGNIFICANCE", 
          target: true,
          current: false,
          satisfied: false,
        }
      ],
      lp_validation_session_id: this.sessionId,
      started_at: Date.now(),
      created_at: Date.now(),
      updated_at: Date.now(),
    });

    // 2. ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯ã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡Œ
    const steps = this.getPB001Steps();
    for (const step of steps) {
      await this.executeStep(executionId, step);
    }

    return { execution_id: executionId };
  }

  private getPB001Steps(): PlaybookStep[] {
    return [
      {
        id: "step-001",
        name: "LPå…¬é–‹ç¢ºèª",
        type: "data_collection",
        order: 1,
        action: async () => this.verifyLPDeployment()
      },
      {
        id: "step-002", 
        name: "PostHog/GAè¨­å®šç¢ºèª",
        type: "data_collection",
        order: 2,
        action: async () => this.verifyAnalyticsSetup()
      },
      {
        id: "step-003",
        name: "Google Adsé…ä¿¡é–‹å§‹",
        type: "optimization",
        order: 3,
        action: async () => this.startGoogleAdscampaign()
      },
      {
        id: "step-004",
        name: "4æ™‚é–“æ¯æœ€é©åŒ–å®Ÿè¡Œ",
        type: "optimization",
        order: 4,
        action: async () => this.scheduleOptimizations()
      },
      {
        id: "step-005",
        name: "24æ™‚é–“æ¯åˆ†æãƒ»æ”¹å–„",
        type: "analysis",
        order: 5,
        action: async () => this.scheduleAnalysisOptimizations()
      },
      {
        id: "step-006",
        name: "æˆåŠŸãƒ»å¤±æ•—åŸºæº–åˆ¤å®š",
        type: "decision_point",
        order: 6,
        action: async () => this.evaluateSuccessCriteria()
      }
    ];
  }

  private async executeStep(
    executionId: string, 
    step: PlaybookStep
  ): Promise<void> {
    const stepExecutionId = ulid();
    
    // ã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡Œé–‹å§‹è¨˜éŒ²
    await this.ctx.db.insert("playbookStepExecutions", {
      workspace_id: "unson",
      execution_id: executionId,
      step_id: stepExecutionId,
      step_name: step.name,
      step_order: step.order,
      step_type: step.type,
      status: "running",
      retry_count: 0,
      started_at: Date.now(),
      created_at: Date.now(),
    });

    try {
      // ã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡Œ
      const result = await step.action();
      
      // æˆåŠŸè¨˜éŒ²
      await this.ctx.db.patch(stepExecutionId, {
        status: "completed",
        output_data: result,
        completed_at: Date.now(),
        duration_ms: Date.now() - step.startTime,
      });

    } catch (error) {
      // ã‚¨ãƒ©ãƒ¼è¨˜éŒ²
      await this.ctx.db.patch(stepExecutionId, {
        status: "failed",
        error_message: error.message,
        completed_at: Date.now(),
      });
      
      throw error;
    }
  }

  async evaluateSuccessCriteria(): Promise<EvaluationResult> {
    const currentMetrics = await this.getCurrentMetrics();
    const criteria = await this.getSuccessCriteria();
    
    // å„åŸºæº–ã®è©•ä¾¡
    const evaluations = criteria.map(criterion => ({
      ...criterion,
      current: currentMetrics[criterion.key],
      satisfied: this.evaluateCriterion(criterion, currentMetrics)
    }));
    
    // å…¨ä½“åˆ¤å®š
    const allSatisfied = evaluations.every(e => e.satisfied);
    const recommendation = this.generateRecommendation(evaluations, currentMetrics);
    
    return {
      overall_status: allSatisfied ? "success" : "in_progress",
      criteria_evaluations: evaluations,
      ai_recommendation: recommendation,
      next_actions: this.generateNextActions(recommendation)
    };
  }
}
```

### UIçµ±åˆï¼ˆãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯è¡¨ç¤ºï¼‰

```typescript
// components/playbook/PlaybookExecutionStatus.tsx
interface PlaybookExecutionStatusProps {
  productId: string;
  currentExecution: PlaybookExecution;
}

export function PlaybookExecutionStatus({ 
  productId, 
  currentExecution 
}: PlaybookExecutionStatusProps) {
  const steps = useQuery(api.playbooks.getExecutionSteps, {
    executionId: currentExecution.execution_id
  });

  return (
    <Card>
      <CardHeader>
        <h3 className="text-lg font-semibold">
          ğŸ¯ ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯å®Ÿè¡ŒçŠ¶æ³: {currentExecution.playbook_id}
        </h3>
      </CardHeader>
      <CardContent>
        {/* å…¨ä½“é€²æ— */}
        <div className="mb-4">
          <div className="flex justify-between text-sm">
            <span>å®Ÿè¡Œé€²æ—</span>
            <span>{getExecutionProgress(steps)}%</span>
          </div>
          <ProgressBar 
            value={getExecutionProgress(steps)} 
            className="mt-1"
          />
        </div>

        {/* ã‚¹ãƒ†ãƒƒãƒ—åˆ¥çŠ¶æ³ */}
        <div className="space-y-2">
          {steps?.map((step, index) => (
            <div 
              key={step.step_id}
              className="flex items-center space-x-3"
            >
              <StepStatusIcon status={step.status} />
              <span className="text-sm">{step.step_name}</span>
              {step.status === "running" && (
                <Spinner className="w-4 h-4" />
              )}
            </div>
          ))}
        </div>

        {/* æˆåŠŸåŸºæº–é”æˆçŠ¶æ³ */}
        <div className="mt-4 p-3 bg-gray-50 rounded">
          <h4 className="text-sm font-medium mb-2">ğŸ“Š æˆåŠŸåŸºæº–é”æˆçŠ¶æ³</h4>
          {currentExecution.success_criteria.map((criterion, index) => (
            <div key={index} className="flex justify-between text-sm">
              <span>{criterion.criterion}</span>
              <span className={
                criterion.satisfied ? 'text-green-600' : 'text-gray-500'
              }>
                {criterion.satisfied ? 'âœ…' : 'â³'} 
                {formatCriterionValue(criterion)}
              </span>
            </div>
          ))}
        </div>

        {/* AIæ¨å¥¨è¡¨ç¤º */}
        {currentExecution.ai_analysis && (
          <div className="mt-4 p-3 bg-blue-50 rounded">
            <h4 className="text-sm font-medium mb-1">ğŸ¤– AIåˆ†æãƒ»æ¨å¥¨</h4>
            <p className="text-sm text-gray-700">
              {currentExecution.ai_analysis.reasoning}
            </p>
            <div className="mt-2">
              <RecommendationBadge 
                recommendation={currentExecution.ai_analysis.recommendation}
                confidence={currentExecution.ai_analysis.confidence}
              />
            </div>
          </div>
        )}
      </CardContent>
    </Card>
  );
}
```

### ãƒ•ã‚§ãƒ¼ã‚ºç§»è¡Œåˆ¤å®šã®çµ±åˆ

```typescript
// convex/phase-transition.ts
export const evaluatePhaseTransition = internalMutation({
  args: { 
    productId: v.string(),
    fromPhase: v.number(),
    toPhase: v.number()
  },
  handler: async (ctx, args) => {
    // ç¾åœ¨ã®ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯å®Ÿè¡ŒçŠ¶æ³ç¢ºèª
    const currentPlaybook = await ctx.db
      .query("playbookExecutions")
      .withIndex("by_product_status", q => 
        q.eq("product_id", args.productId)
         .eq("status", "running")
      )
      .first();

    if (!currentPlaybook) {
      throw new Error("No active playbook execution found");
    }

    // ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯æˆåŠŸåŸºæº–ç¢ºèª
    const allCriteriaSatisfied = currentPlaybook.success_criteria
      .every(criterion => criterion.satisfied);

    if (!allCriteriaSatisfied) {
      return {
        recommendation: "continue_current_phase",
        reasoning: "ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯æˆåŠŸåŸºæº–æœªé”æˆã®ãŸã‚ç¶™ç¶šå®Ÿè¡Œ",
        unsatisfied_criteria: currentPlaybook.success_criteria
          .filter(c => !c.satisfied)
      };
    }

    // ãƒ•ã‚§ãƒ¼ã‚ºç§»è¡Œæ¨å¥¨
    const nextPlaybook = getNextPhasePlaybook(args.toPhase);
    
    return {
      recommendation: "approve_transition",
      reasoning: `${currentPlaybook.playbook_id}ã®å…¨åŸºæº–é”æˆã€‚${nextPlaybook}ã¸ã®ç§»è¡Œã‚’æ¨å¥¨`,
      transition_plan: {
        from_playbook: currentPlaybook.playbook_id,
        to_playbook: nextPlaybook,
        estimated_duration: getPlaybookDuration(nextPlaybook)
      }
    };
  }
});
```

## ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯è‡ªå‹•å®Ÿè¡Œãƒ•ãƒ­ãƒ¼

### 1. PB-001é–‹å§‹ãƒˆãƒªã‚¬ãƒ¼
```mermaid
graph TD
    A[æ–°ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆç™»éŒ²] --> B[LPå…¬é–‹å®Œäº†]
    B --> C[PB-001è‡ªå‹•é–‹å§‹]
    C --> D[Google Adsé…ä¿¡é–‹å§‹]
    D --> E[4æ™‚é–“ã‚µã‚¤ã‚¯ãƒ«æœ€é©åŒ–]
    E --> F[24æ™‚é–“ã‚µã‚¤ã‚¯ãƒ«åˆ†æ]
    F --> G[æˆåŠŸåŸºæº–åˆ¤å®š]
    G --> H{åˆ¤å®šçµæœ}
    H -->|æˆåŠŸ| I[PB-002ç§»è¡Œæ¨å¥¨]
    H -->|ç¶™ç¶š| E
    H -->|å¤±æ•—| J[PB-001çµ‚äº†ãƒ»åˆ†æ]
```

### 2. ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯å®Ÿè¡Œç›£è¦–
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€²æ—**: ã‚¹ãƒ†ãƒƒãƒ—å®Ÿè¡ŒçŠ¶æ³ã‚’UIè¡¨ç¤º
- **æˆåŠŸåŸºæº–ç›£è¦–**: CVRãƒ»ã‚µãƒ³ãƒ—ãƒ«æ•°ãƒ»çµ±è¨ˆçš„æœ‰æ„æ€§ã‚’è‡ªå‹•è¿½è·¡
- **AIåˆ†ææ›´æ–°**: 4æ™‚é–“æ¯ã«AIæ¨å¥¨ã‚’å†ç”Ÿæˆãƒ»æ›´æ–°

### 3. ãƒ•ã‚§ãƒ¼ã‚ºç§»è¡Œåˆ¤å®š
- **è‡ªå‹•åˆ¤å®š**: æˆåŠŸåŸºæº–é”æˆæ™‚ã«ç§»è¡Œæ¨å¥¨ã‚’ç”Ÿæˆ
- **äººé–“æ‰¿èª**: æœ€çµ‚çš„ãªç§»è¡Œåˆ¤æ–­ã¯äººé–“ãŒå®Ÿæ–½
- **æ¬¡ãƒ•ã‚§ãƒ¼ã‚ºæº–å‚™**: PB-002ç­‰ã®æ¬¡ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯æº–å‚™

## ã¾ã¨ã‚

ã“ã®çµ±åˆã«ã‚ˆã‚Šã€LPæ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ ã¯å˜ãªã‚‹è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ã‹ã‚‰ã€Œ**ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯é§†å‹•å‹ã®æ¨™æº–åŒ–ã•ã‚ŒãŸãƒ—ãƒ­ãƒ€ã‚¯ãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®ä¸€éƒ¨**ã€ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚

### å®Ÿç¾ã•ã‚Œã‚‹ä¾¡å€¤
- **æ¨™æº–åŒ–**: PB-001ã®ç¢ºå®Ÿãªå®Ÿè¡Œã§å“è³ªæ‹…ä¿
- **è‡ªå‹•åŒ–**: æ‰‹å‹•ä½œæ¥­ã®90%å‰Šæ¸›
- **å­¦ç¿’**: å®Ÿè¡Œå±¥æ­´ã‹ã‚‰çµ„ç¹”çš„å­¦ç¿’ã®è“„ç©
- **ã‚¹ã‚±ãƒ¼ãƒ«**: è¤‡æ•°ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆä¸¦è¡Œå®Ÿè¡Œã®åŸºç›¤

ãƒ—ãƒ¬ã‚¤ãƒ–ãƒƒã‚¯çµ±åˆã«ã‚ˆã‚Šã€UnsonOSã®ã€ŒCompany-as-a-Productã€ãƒ“ã‚¸ãƒ§ãƒ³ã®å®Ÿç¾ã«é‡è¦ãªä¸€æ­©ã¨ãªã‚Šã¾ã™ã€‚

---
*Last Updated: 2025-08-20*
*Related: docs/strategy/product-management-system.md, docs/playbooks/pb-001-lp-cvr-test.md*